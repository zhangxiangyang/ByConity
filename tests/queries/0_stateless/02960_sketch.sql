DROP TABLE IF EXISTS test.test;

CREATE TABLE test.test
(
    `test_col` Int8,
    `test_col2` SketchBinary
) ENGINE = MergeTree() ORDER BY test_col;

INSERT INTO test.test values (1,'CgEHDAAAAAqewZMzSTcuQQAAAAiLxihAAAAAAAAAAAAAAAAAAAAAAAcMCQsLCQgICQ0KCgkICgkJCwkIDAgKBwcNCggLCQgIBwkKCQwLCQcICQoICQoKCgkHBw0GCAoJCQsKCAoJBwoLBw0ICQoIBgkICQkJCw0JDAgOCAkICAoMDgcICQgKDQkHCgcICwgICQcMCgoJCwwJCAoJDAcICQYKCwoIBwcHCQwGDAsIBwcLCwsICggKCwoLCAkICQ4KCgkLCAcLCggJDwoICQoKCQ4LCgoICgkMCQkJDAkHCAgICAcIDQgKCQoJCQcOCAkKCgwJDQkICggJCgcJCAgJCAgHCgkKCAoIBwgKCAgKCQcJCwgJCAkKCAoOCgsJBwoICwkNDgkJCQ0KCQkHCQwLCQcMDAwLDQkLDAkHCQ0LChAKCAoICQkHDAsJBgsJCAgJCwkMDAwKCAkJCQkRCAgKCQgICgkSBwwLCQsHBwgHCAcHCAkLBwkKCQcICggIBwgHCAcHBwsHDAsKCgcJCAgKCQgICAYKCQwIBwcMCwcJCggNCQYJCAcHCQ4JCAoKBgoIDAkLCgsJBwoLCQcHCwcICAcICQoIDAgICA4MCgkJCwkLCgwICQsKCAYHCAkKDAsIBwkNCwsKCAwJCgsLCAgLDAcICAwKCQgMBwoHCAwICAoICAsFDQoICQkJCgkLDgkHCgoJCwkICgoHCggHCgcKCAkLCgsHCQoICQoHCg4LDQcICA0LCAgMCAgHCgoICQgJDQkJBwoHDAgICgkHCwcKCQsLCggLCAoJCAcMCgkKCgkHCg4JBwoLBwoKCAcHCgoICAYICQ0KCAgJCQgKCAgJBwsIDAgIBwcJCQoJCggKCggJCQoJDwkIDAkICQgMCwwHCAsMBwgKCggIBgkHCAgIBwkNCAgMCQkICAgLCAoICQoLBwcGCAkMCAsLCwwMBwkJCRENCAkMCQwHCQkIBwgMCwgHCAgICAkJCAkGCgoIDQgICQkHBwoJCQkOCQkICgYJCQgHDAsJCQkIBgoMCgYQCgoJCg8MBwgKBwoKCgwHBwwMCAkLCAcICAwJCQgKCg4KCgcHCAsHCAkICgkIDQkJCgoLCgkKCQoJCQoKCQcICwoJDQgLCQcMCQ8ICg8ICAcKCwgHCQkIBgoICAwQCAgPCgkKBggMCgsJEwgGDQgICAgKCQkJCAkLCAoJCwcIDwgKCQYJCwoJCQgJCAkLDQkHCQoLCwcLCAwMCwkLCgoPCwsHCQkICQkICAoKCQsMCQgJCQcNCQgLCQkJCQkJCAcLCgsKBwcKBwsJCwcMCBESBwgJCAkICwcHDAgKBggHCQkJCAgNCgoJDQgJBwcKCQcJCgkIBwcIDAgHCAgLCQcLCggHCgcICAwKBwsIBwkHCAoKCgcLCwgNCwkHCAgICQcKCgsHCQkJCwwGCgoJCQoLCwoICQkJCAsHBwgICA4JCAkJCgsMDQ0KDAwHCQ4MCQkIBwsJDQgKCQwICAsIBwgKCgkHCgcMCQgLDgoKCggJCAoJBwkICAgKCgwGCAkIBwoKBwkPCw4HCggICAkJCAgJCQgGCQgKCQcICQ0ICwgJCQcJCAgMCAsJCgsKCQgIBgoIDAgJCAYJCQgHCAwHCAkICQoMCgkJCQcJDQsHCAgGCAkIDgkICQgIDAgICQkJCwsHCQcICwwJCAYKCgkJCggIBwgKCQkICQkICQoIBwoLCw0LCggMCQgIDQoJDggJCAsKDgkICQkKCAoLCAsKCAgICQkHCwkPCwoHBwkJCgsKCAgJCAgICAkLBwoMCAoJCQkIBwsKCQoSCAkKCAoJCwkLDQoJCQkMBgkKBwcICQgJCQgKCwcJCQgKBwsMCQgICQkICQgJCggKCQgNCAkHCQoKCgkNBwkICAkJCwsMCgoGDAsICAgJCwgKCQgHCQoJDAgKCAgJDQgMCAsNCAgICQ8JDAYIBwgJBwoMCQ8JBwoIDAcNCAgJDAgKCAkJCggMBwcICQkJCgcIBwkGBwgICAcKCAgICgkJCQwJCwsJCAsLCggKCwgMCgkJCQgIBwkJCQgKCAgKCwkIBgkKCwoPCAcICwgICgoJDggMDAYLCggPBwoLBgsJCgkHCQgHCgkMCAoLCQgHBwkICAgJCAgJBwoICggHCQkJBg0KCAoHDAgICQkJCwcNCwkJCQgMCQwICQcIBggHBwsJCQcIBwoICwoJBwwJCBIKDQgHCggKEAgJCQgJDQgICgsICQcJCgkLCAcJCQcICAcKCQgICQkHCgwKCAkJCAsICwoICAoKCwcKCgkIDA0ICAoHBgcKCQYMCAkIDAkMCgcICQcLDAoKCggJCAoJBwgICQcOCAsHCQsKBwgJCAwHCQcJBgkKCggKBwgLCAkICAoKCwgNBwgHDAcMBwsICw8JCQkIBwcGBwgICAgJCQoICAoJBwsJBwsICgsKEAsLCQcHDAwJCAsGCQgHCQYHCQsICQgICgwLCgcKCQgJDQkMCQ0ICgsHCgkLCAkMCgkLCAoJBggHCQoKCQwKDQsICwgHCgoGDgkKCgwMBwoICwgLCwoKCQwJCQkHCAkIDQsKCwsMCQsMCwkJCgoHCgkJCAgHCAYKCwsICAoIDQcOCQsIBwwJDwoKDggKCQwICAkIBwkJCgkMCAkJCg0JCAgIBwkKCgsJCgkKCgsICQcKCAkMCQoJCAkICgsJCgcLBwgJCQgKBwgHDgcHCAgOCAgIBwkKDQgJCgYJCQkLCggJCwgICQoICQgKCgkJCAsICAgKCwkLCgcJCQkHEwkICAgKCgcKCQsIDAoMBwoLCg0ICwkLCAkICwcKDRAHCQcHCQkJDAkGCwcICQoMCAkPDAgIDQkICAkNDwsHDAkICQgJCgkICAgJCwgGDAcLBwkHCQkJBggMCggIBwcKDgoJDgcLCAkKCAYIBwsJCwgJBwwICAsKBwcHCA0ICQkJBwwHCQgHCAkIBwgICAoJCwkICAsKCgkJCgsJCg0MCwkIBwsHEgoHBw0LDBALCQgLCgcHCAgLCAoJBwcICQoHCgoJCAgICQoLCQYICQgKCQgKCAgKDAkICAgSCwoICgsMCQwJCAoNCgoKCAsMCgcLDQ0GCggHCQgKCAkNCQkLDAkKCwgJCQsMCAkJBwkJBwoNCgsICwkMCQwJCQoIBwYHCwcIDgkLCgsICAcICQcICAkJCggLCQwIBwoKCQ8LCwsJCQ4KCg0LCgsKCAcKCwgJCwkPCggMCw4KCAoICQkICAoLDQoMDgsJCQsLCAcICwkIBwcJCAoIBgoLCAgOCwgJCgcMDQgICQcGCAoHCQcHCQoKEQgJBwcKCQ0JCAkHCgkIDAkJCgoGCwcICAsJCgcHDgoJCQgJCAkMBggMBwgKCAgMCQsICQoMCAkHCgsICwoICQoICQgICAkJCgwLCAoKCggIBwkLCwoJCAsJCQkLCQYKCQcIBg4ICgcMBgcJCQoMCQkJCAsICQsICgkJCAgHCAkKCAgIDAoICQgICQwJCAkKCAgJCxELCQkHCQgKBwkJCQkICgkGBwgHCAgGCA8JCwoIBwcHBwgIBwcHCwsJCAkHCQoOCAoICAcKCQcLDAgIDQcJCAoKCg0HCAYICQkICAoICQ0ICgkNCAsJBgkGCAgHBwkICggMCAkKCwoICgkKCQgICQsIEAsGBwYKDAgKCAsLBwgJCgsHCgcICAkNCAgLCAsGCQgOCgkKDQ0HCAcMBwkJCQgKCgsMCQkGCQkKDgkJCAwJCwkIEggKCAoKCQgICgsIBwwMBwoJCgsLDQoJCQsMCQoGCAgICAkHCAkLCgcHCAgKCQkJCQgICAgKBgoIBgsGBwgKBwwHCwwLCwkLCgkHDQwICwkICA0ICQkKCggKCAgJCggJCgkLCQcKCgYKCgoMCAgKCgkKCQgJCQoICAsICgoIBwkHCQwICgkHBwoICQgICQsJBwgPCQkMBwgJCAgPEAoKBwgGBgoHBggKCAgLCQgJCAgHCQkJDgcIBwYNCgkKBw8QCAsICwkHDQgLCQoJDQoPDQkGCwkNCAkJCAkHCQgHCQgHCQoLCgkICwkLBw4IBwoKDAcKCAcICA0PDQcICAgMCgoLDAoICgcLCgkICgkHCAoKCwgICQoICwwJCgkHCQgJDQsKEAkJCQkMDAYOCAgJDgoJCAcJCwsKCQgLCgkLDgoKBwgICgsJDwgICA0LCA0IDQgMCAgKCggJCQgICQsJCAgMCAgHCQsIDAwKCAoJCAkIDQkKCQYKBgoGCQ0ICgkIBggICQkICggLBwkJCggKCQgJCAoJCAgKCQoIBwkICQgICAcMCgkJCgkLBwwKDAcNCAgJCwoICQsHCwkKCQoKBwoICggJCAcJFgoICwcLBw0JCAkICAkKCQcMCAkICggICQ4MBwcMCQgJCAgHDAcJCAoLCAsJCwcKCAgHCAsICwkICAsHCAkJCAkJCAkJDwgLCg8IDQYKDwsHBwkKDAkKCQYICAoMCQoKBwYIBgsICwoKBwsJCggHCAgJCAsHCQgICwgICwgJCAgJDwcICQgJCAgJCgsJCAoHCAcJDQwHCgoKCAkLDAcJCQgIDQgJCQgKCQgNCgcJCggHCQoIBwgOCQgKCQoJCAkJCQ4JCwoKCAkHBwoHCREJCgoIBwwJCAkJCQoJCAsMCgkHCggHCAsPCAwJCAcICwoJCQsHCwgIBwoKCAkLCAgKBwgIBwgLCA0JCAkHCwkNCwcJCggHCAgHDAgODgkJCQoLCgoKCQ0JCQkLCAgJCAcMCwgHCAkICAsKBwgHBwgKCwgIBwkICQcICQcJCwkGBwgMCAgLCQkJCAoGCAkMCgkHDwcQCwcICggJCQcMCAsIDgkLCQgKCg0JCAgKCgkICAkKCggJBwkHCg0NBwcJBwgHCQkHCA0KCQkJCQoJCAgHBwoJCQwICAcICQgJCwgJCwwICQcJCwgKCAoHDAYIBwgICggMBgsOCAkJCgoICgoJCgkJBwoHCwgJBggKCQgHCQwJCg4JCAgKCAsJCgsHBgoIDAkKCggKCAcMCwgNCAoJBgsIBwwJCAoJDwkICQgOCgkICggJCgYJCAcJCgkJCAgNCggICg0JCggKBwsLCAcHCQwMCQsNCggICQkJBwsIDgkRCQoJDwkHCwcMDAgICQsLDAkICQcJCAcJCAoHBwsLCAoJCAYJBggICAcKBwgJCA0LDAgJBwYKCAkJCAoGBwkLCgwKCgkHCAgJCQYJCQgLBwkNCgcKBgoKCQkICQoLCAwLCgsICAkNBgYICQsJCAkICA0JCgsJCwoNCQgHDAoKCQgLBgkKBwkHCwwICgcJDwgJBgoKBwkLCAkHCQgHCAcKCggICAgKCgcHDAcIBwgPCAYMCwgICQkICgsHCwgICAYIDQkLCAcKBwoJCAgHCgkIBgcICQkLCAgKCwgHBwkJCAkGCQkICAsMCgoHBwkIBwgJCggHCwgKBwcJBwwJDQwIDwoKCgkMDAwMCgcICgsKDAcKCQkIBgwHCAcLDgs=' );

SELECT hllSketchEstimate(test_col2) FROM test.test;

INSERT INTO test.test values (2,'CgEHDAAAAAoHoXgVsEMfQQAAAGTWrzdAAAAAAAAAAAAAAAAAAAAAAAYLCQgLBwcGBwcKCQkHCgYHCwcICggKBwcNCQgHCQcHBwkKCQcHBgcHCAoICQcKCQkHBg0GCAoJBggKCAoHBwoLBw0ICAoIBggHCQgJCwcIDAgOCAkHCAcHBwYHBgcKDQgHBgcICwgIBwcJCgoJBggGCAoGDAcICQYHCwoGBwcHCQwGCAsHBgcGCwsGCAYKBwkICAkIBwgHCgkLCAcLCgcJDwgICAoKCAgLCgcHCgcMCQcHCAkGBwgHCAcHDQYKCQoHCQcOBwgICgwIDQgICgcICgcJCAgJCAgGCQkICAoIBggKBwYKCAcJCgYJCAkKCAgOCgsGBwoICwkNCgkHCQgHCQkGBgYLCQcMBwcLCQkLBwkHCQcIChAKCAoICQkHDAsJBgcJCAYJCAgJCQYKBwkHCQcRCAcGCQgICgkJBwwIBwcHBwgHBgcHCAkLBwcICQcHBwgIBwgHCAcGBwsFCgsJCgYIBggGCAgICAYKBwkIBwUMCwcJBwgGCQUJCAYFCQ4JBwoKBQcHBwcHCQkHBwcLBwcHCwcICAYHCQgICAgHCA4HCggJCwkKCAgICQgKCAYHCAkHBwsIBwkJBwsICAwJBwoICAYHDAcIBgkHCQgMBwoHCAoICAoHBwoFBwoICQcJCAcJBwkHBgoJCwkICAoHCggHCgcHCAgLCQsHCQoGBgkHCg4LDQcICA0LCAgHCAgHCgoICQUJDQgJBgoGBgcIBgkHCwYKCAkHCgcGBwgJCAcMCQkJBwgHCQkIBwoLBwoKBgcGCgYICAYICQgJCAUICQgIBwcJBwcIBwYHBwcJCAoGBggHCAgJCQgJCQkIDAkGBgYHCwcHCAsJBwUICAcIBgYHCAgHBggHBggMCQkIBwcLCAoGBwoGBwcGCAYJBwsGBgYIBwYJCRENBwkKCQwHCQkIBwgICggHCAgIBwkHBgkGCgoHDQgICQkGBwgICAkHBgkICgYJCQcHCQsJCQkIBgoICgYOCgoJCgsKBggIBwoKBwcHBgYLCAgFBwcICAYHCQcKCAgKBwcHCAsGBgkHCgkIDQkJBgoLCgcHCQoJCQYKCQcHCgcJDQgLCQcICQ8ICg8GCAYHCwgHCQkIBgoHCAgQBwYPCgkIBggHCgsGEwgGBgcIBwgKCQcJBwkLCAoHCwYHDwgIBgYJBwoJCQgJCAkHCQYHCQgLCwcLCAwGCwkFCQoLCwcHCQkICQkICAoKBgsJCQYJCQcHBggLCQkIBwcJCAcKCgsKBwcIBgYHCQcMCBEJBwgJCAkICwcHBgcJBggHBggICAgNCQYJCggIBwcKCQcJCgkIBwYHDAgHCAgKCQcICggHCgUICAwIBwgIBwcHBwoKBwcHCQgNCwcHCAgIBwcKCgoHBgkJCwwGCgoJBgoLCQcGBwkJBwsGBwgIBg4JCAkICgsIDQkKBwoHCQYMCAcIBwsHCwcHCQcGCAsIBggKCgkHCgYGCQgLBgYGCggJCAoHBwkICAgKCgYGCAkHBwkHBwcPBw4HCggIBgcGCAcJBQgGBwgKCAYIBwoICwYJCAcJCAcMBgsICQcKCQgIBgYHDAgHCAYHBwYHBwwHBwgHCQoMCgYICQcJCAYHCAgGCAYICgkGCQgHDAUICQkGCwsGBwcICQwJBgYHBwkFCggIBwgKCAkHBgYICAoIBwoLCgYGCAcMCQcICQgJCwgICAsICQkGCQkGBwoLCAsKCAcICAkHBwYPCAYGBwkHCgUHBwcJBwcGCAkHBwoMBwYHCQkIBwgKBgoSCAkHCAkICQULBwoHCAcIBgkKBgcHCQgHCQgKCwcJCQgKBgsHCQgICQYICQgJBgYKCQgGCAkHBwcKCgkNBwkIBwkJCwgMCgcGDAgHBgcFBQgKBwcHBwUJBwYGCAgICggMCAoNBwcGBQoHBgUIBwgJBwcMCQkJBgYIBwcGBwgIDAgKCAYGBwgIBwUICAkJCQYIBwkFBwgICAcKBggHBgkIBgoJCAYHCAYICggHCwgLBgkJCQgHBwkHBwcKBwcKBwkGBgkKBgoHBwYGCwgHCgcGCQgHCQYLBwgPBwoLBgYJCggHCQgHCgkIBgoKCQgGBwkICAgJBwgIBwoHCQcHCQgJBg0KCAoHBwgIBwkHBwcICwgJBwgJCQgICQYIBggHBwsJBwcIBwoHCwoJBwwJCBIKBggHCggIEAYJBwcHDQgICgYICQcGBwYJCAcJBwcIBwcGCAcICQcHCAwHCAgHCAkICwgIBwoHCwcKCQkIBg0HBwoGBgcKBwYKCAcHDAgGCgcICQcICAoHCggICAoHBwgIBwcICAoFCAsHBwUJCAwGCQcJBggHCgcKBgcLCAkHCAcKCwcNBwYHCQcKBwsIBw8JCAcIBgYGBQcIBggIBwoICAoJBgsIBwUIBwYIEAsJCQcHDAcIBwgGBggGBgYHCQsGCQgIBgwLCgYKCAUJDQgHCQcICgkGCQkLBgkLCAkHBgoIBggHCQoKCQwKDQkHCAgHBwoFBwgKCggMBwoHCwgLBwYGCQYHBwgHCAgIDQsKCwgIBwcJCwkJCgoHCgkHCAgHBgYHCwsICAgIBwYMCQcHBwwJDwcIDggHCQwICAkIBwkJCggMCAkJCg0JBwgIBwgHCgsGCgkJCgsHCQcKCAkIBwcGCAkHCQgHCgcKBwcJCAgHBwcGDgcHBwgOBwgHBwcHDQcJCgYJCAcHCgYJCgcICQoICQgHCgkJCAsHCAYJBwkHCgcICQkHCAYICAgJCAcKBgkHDAgMBwoHCgYICwkLBwkHBwcHCAkGCAcHCQgGDAkGBgcGBQoHBggIDAcHDQgHCAgNCQgHDAgGCQgICgkGBwgJBwcGDAYJBwkHCQkJBgYMBwgIBwcICAoHDgULBwkKCAYIBwsGCggJBwwICAkKBwcHCA0ICQcJBwwHCQgFBwkIBwgHCAoJCwYHBgcKCQgICAYJCg0GCgkIBwYGEgoHBgkLCAgLCQcLCgcHCAcLBwcJBgcICQoHCAoICAgFCAcLCQYHCQgKCQgKBwgKCQcICAgQBwoIBgcJCQwJCAoICgoJCAgKCgYIDQwGCAgGCQYKBwcNCQcLBwkKCwgJCQcLCAYJBgkIBgoICQkICQcJBgwHCQoHBgUGCwUIDgkLCQsICAcGCQcIBwkGCgYGBwwIBwgICQ8LCQsJCA4KCg0HCAgKCAcKCwYGCAkPCggFBwgHCAoICQkIBwoLBggHDgkJCQsJBgcFCAkGBgcJBgoIBgkLCAgOBwgJBwcLDQgICQcFCAgHCQcHCAkHEQgIBwcKCA0JBwcHCgcIDAkICAkFBwYICAsJBwcHDgcHCAgJCAkMBggMBggIBwgKCQoIBwoMCAUHCgsHCwoICQkIBggHBwkIBwwLCAoKCgcHBwYHCwgJCAkJCAkHCQYJCAYIBgoICgcIBgcJBwcMCQkICAkICQsGBwYJBwcHCAYKBggICwgICQgIBgcICAUHCAgHBwULCAkGBwgKBwkJCQkGBwkGBwgHCAgGBwgICAkHBwYHBwgIBwcHCQsHBQkHCAoOCAkHCAcICAYLDAcIDQcIBgkKCgoHCAUGCQgICAoICQ0IBwkJCAoJBgkGCAUGBgkHBwgICAkHCAoICggKCQgHCAoHEAkGBgYKDAcJBwsJBggJCAsHCgcGCAkNBggHCAsGBwgOCgkKCwYHCAYHBwkHCQgGCAcMCAgGCQgKDgYIBwgJBwkIBwgHCAcJCQgHBwoHBwwMBgoJCgsHCgoJCAsMBgoGBwgIBwcGCAYLCgYHCAcKCQkHBwgHCAgKBQgHBgcGBggKBwcHBwwHCAkLBQkHCAwICwkICA0FBwkICAcJCAYIBgYJCgYLCQcKCgYKCgcLCAcKCgkICQgJBQoHCAYICAkIBwcHBgcGCgkHBQYIBggIBwsGBwgICQkIBwgJCAcPEAcGBwcGBgoGBggKCAgLCQYJCAYHCAkGCAcIBwUJCQkJBg8HCAsICwcHDQcLCQoJBwoKDQgGBwYFBwkGCAgHCQcGBwgHBwoLCQYICQgGBw4IBwoKCwcICAcIBwoJCAcIBwcIBwoICgkGCgcLCggICgcHCAoKCwgHCAgHCAwJBwgHCQgJCAsKCAcGCQgHBgYJCAcJCwYJCAcHBwcICAgHBwgLDgoKBwgIBwYHCAgIBggICAcIDQgMCAYKCggHBQgIBgsJBwgMCAgGCQkIDAwHCAgJCAYGDQgKBwYGBgoGCQgHCgkIBgUICQkICggIBwcGBwcHCQYJCAoJCAgJCQoIBwcHCQgGCAcMBwkJCgcLBgwKDAcHBwgJCwgICAcHCwkHCQoGBwcICAgHCAcIFgkICwcLBwoJBgkICAcKCQcMBwcHCAcGBgoMBwcIBwcHCAcGDAcGBwgJCAsJCwcHCAgHBwsICwgICAsHBgkJCAkJBwgJDwcKBwgICAYHDwgHBwkKDAkKCAUICAoHBgcKBgYIBggICwkJBwkJCAgGCAYHCAcHCQgIBwgGCwcJCAgIDwYHBgYJBggJBQgJCAgHBwYJCAoGBwoICAkIDAYHCQgGBQcICQgKBwgKCgUJBwcHCQoIBwgHCAgKBwoJCAkJCQgJCwoHCAkHBgoGBhEJCgoGBwwJBwgJCAgJCAsHBggHCgYHBwcPCAYJBgcICAoJCAsHCAcHBwoKCAYJCAgHBwgGBwgIBw0ICAkHCwkFCwUJBwgHCAgGDAgODgcJCQoLCgoKBg0HCQcLCAgJCAcMBgUHBwkICAcKBwgGBggKBwgHBggHCAcHCQcHCwkFBwgMCAgLCQkJCAoGBgkICgkHBwcMCwYICQgJBgYICAgGBwkHCQgKBwYHCAgKBgkICAgKCQgJBwkFCg0KBwYJBwcHCQYHBgcICQkJCAgJCAgHBwoICAgIBgYICQYJCgcICwwIBQcGBgcICAgGDAYIBwgIBwgMBgsHCAkIBgYICgoJCgkJBwgHBgYIBgcKBwgGCQwJCg0ICAgKBwcGCgoHBgoIDAUICgUIBwcMCAcNCAoJBQsIBgcICAoJCggICAgOCggIBwgJCgYJCAcGCQcJCAgNCgUICg0JCQgKBgsGCAcHCAwMCQgNBwYHCAcJBwsICAcHCQcIDAkHCwcMDAYICQYHDAkGCAYJBwcJCAoGBwsKBwkJCAYIBggHBwcKBwgJCA0LBwgJBwUKCAkJCAoGBwkLCgoIBwkFBwcICQYJCQYLBwkJBgcKBQcKCAkICQoLBQwLBwgIBgkIBgYIBQsJBgkIBg0JBwkJCwoICQcHCAUKCQcHBgcKBwcGCwwHBgcJDwgJBggKBgcHCAgHCQgHBwYHCggFBwgJCgYHCQcHBwYPBwUICwcHCQkHCgkGBwgICAYHCAkIBwcKBwoJCAcHBwkIBQYIBQkJCAgKCgcHBQgJCAkGCQkICAkICgoHBwkIBwgHCgcHCQgIBwcJBgwHBgcICAgKCAkMDAkMCAYICQkICAcKCQkIBgkHCAcIDgs=' );

SELECT hllSketchEstimate(test_col2) FROM test.test;

INSERT INTO test.test values (3,'CgEHDAAAAArQUrBvY74mQQAAAKSknDBAAAAAAAAAAAAAAAAAAAAAAAcMCQsLBwgICQcKCQkICgkHCwkIDAgKBwcNCggHCQgIBwkKCQwHCQcHCQoICQoKCgkHBw0GCAoJCQsKCAoJBwoLBw0ICQoIBggICQkJCw0IDAgOCAkHCAcMDgcIBggKDQgHCgcICwgICAcJCgoJCwgJCAoJDAcICQYHCwoGBwcHCQwGCAsHBwcJCwsHCgYKCwoLCAkICQ4HCgkLCAcLCggJDwgICAoKCA4LCgoHCgcMCQkHDAkGCAgHCAcIDQgKCQoHCQcOCAgKCgwIDQgICggICgcJCAgJCAgGCQkICAoIBwgKCAYKCQcJCggJCAkKCAgOCgsJBwoICwkNDgkJCQ0HCQkGCAcLCQcMDAwLCQkLDAkHCQcLChAKCAoICQkHDAsJBgcJCAgJCwgJCQYKBwkICQgRCAgKCQgICgkJBwwLCQcHBwgHCAcHCAkLBwcICQcHBwgIBwgHCAcHBwsHCwsKCgYICAgICAgICAYKCAwIBwYMCwcJCAgNCQYJCAYHCQ4JCAoKBgcIDAcLCgsHBwoLCAcHCwcICAYICQgIDAgHCA4HCgkJCwkKCgwICQkKCAYHCAkHDAsIBwkNCgsKCAwJBwsICAYLDAcIBgkICQgMBwoHCAoICAoICAoFBwoICQkJCAcJDgkHBwoJCwkICgoHCggHCgcKCAgLCgsHCQoICQkHCg4LDQcICA0LCAgHCAgHCgoICQYJDQgJBgoGDAgICgkHCwYKCQsHCgcIBwgJCAcMCgkJCAkHCgkJBwoLBwoKBwcHCgoICAYICQ0JCAcJCQgKBwgJBwcIDAYIBwcJCAoGCggKCggJCQgJCQkIDAkIBgYICwwHCAsMBwYJCAcIBgkHCAgIBwkHCAgMCQkIBwcLCAoGCQoHBwcGCAkJBwsICwcMBwkJCRENBwkKCQwHCQkIBwgICwgHCAgIBwkJBgkGCgoHDQgICQkGBwoICAkHCQkICgYJCQgHCQsJCQkIBgoICgYQCgoJCg8MBggKBwoKCgoHBwcMCAgHBwcICAwJCQcKCQgKCgcHCAsHBgkICgkIDQkJCgoLCgcKCQoJCQoKCQcHCwgJDQgLCQcMCQ8ICg8ICAYHCwgHCQkIBgoHCAwQBwgPCgkKBggMCgsJEwgGBwgIBwgKCQkJBwkLCAoICwcIDwgICQYJCwoJCQgJCAkHDQkHCQgLCwcLCAwLCwkLCgoLCwsHCQkICQkICAoKCQsJCQYJCQcHBwgLCQkJCQcJCAcLCgsKBwcJBwsJCwcMCBEJBwgJCAkICwcHDAcKBggHBwkICAgNCgkJDQgIBwcKCQcJCgkIBwYHDAgHCAgKCQcLCggHCgcICAwKBwsIBwcHBwoKBwcJCwgNCwkHCAgIBwcKCgsHCQkJCwwGCgoJCAoLCwoHBwkJBwsHBwgIBw4JCAkICgsLDQ0KDAoHCQ4MCAkIBwsHCwgKCQwICAsIBggKCgkHCgcHCQgLBwgGCggJCAoJBwkICAgKCgcGCAkIBwoHBwcPBw4HCggICAkJCAgJBQgGBwgKCQcIBwoICwgJCQcJCAgMCAsJCgcKCQgIBgoIDAgJCAYHCAcHCAwHBwkHCQoMCgYJCQcJDQYHCAgGCAkIDgkGCQgHDAgICQkJCwsHCQcICwwJCAYHBwkJCggIBwgKCQkICQYICAoIBwoLCgkGCAgMCQgICQoJDggJCAsICQkICQkKBwoLCAsKCAgICAkHBwYPCAYGBwkICgcKBwgJCAcHCAkLBwoMCAYJCQkIBwsKCQoSCAkKCAkJCQULCgoHCAcMBgkKBgcHCQgJCQgKCwcJCQgKBgsICQgICQYICQgJCAgKCQgNCAkHCQoKCgkNBwkICAkJCwsMCgcGDAgHCAgJCwgKCQcHBwoJDAgKCAgJCggMCAsNBwgICQoHDAYIBwgJBwoMCQkJBwoIDAcKBwgJDAgKCAkICggIBwYICQkJCgcIBwkGBwgICAcKBwgIBgkJCAwJCAsJCAsLCggHCwgMCgkJCQgIBwkHBwgKCAgKCwkIBgkKBgoHBwcHCwgICgcJDggMDAYLBwgPBwoLBgsJCggHCQgHCgkMBgoLCQgHBwkICAgJCAgIBwoICggHCQkJBg0KCAoHBwgICQkHCwcNCwgJBwgJCQgICQYIBggHBwsJBwcIBwoICwoJBwwJCBIKBggHCggKEAcJCQgJDQgICgsICQcICQYJCAcJBwcIBwcKCQgICQkHCgwKCAgJCAkICwoICAoHCwcKCQkIDA0ICAoGBgcKBwYMCAgHDAkJCgcICQcLCAoHCggICAoHBwgICQcICAsGCAsHBwgJCAwHCQcJBgkHCggKBgcLCAkICAoKCwcNBwgHDAcKBwsICw8JCQcIBwYGBQgIBggIBwoICAoJBgsJBwsICgcJEAsLCQcHDAcJCAgGCQgGCQYHCQsGCQgIBgwLCgYKCQYJDQkJCQ0ICgkHCQkLCAkLCgkLCAoIBggHCQoKCQwKDQsHCAgHBwoFCAkKCggMBwoICwgLCwoGCQYHCQkHCAgIDQsKCwgICQsMCwkJCgoHCgkJCAgHBwYHCwsICAgIDQYOCQsHBwwJDwcIDggKCQwICAkIBwkJCgkMCAkJCg0JCAgIBwgHCgsHCgkJCgsHCQcKCAkICQcJCAkICQsHCgcLBwgJCAgHBwgHDgcHBwgOCAgHBwgJDQcJCgYJCQkHCggJCwgICQoICQgHCgkJCAsHCAgJCwkLCgcICQkHCAYICAgKCgcKCAkIDAoMBwoLCggICwkLBwkHCwcKDRAHCQcHCQkJDAkGCAcIBwoHCAgIDAcIDQgHCAgNCQgHDAkGCQgICgkIBwgJBwgGDAYLBwkHCQkJBggMCQgIBwcKCQoJDgcLCAkKCAYIBwsICggJBwwICAkKBwcHCA0ICQcJBwwHCQgHCAkIBwgICAoJCwkICAcKCQgJCgsJCg0GCgkIBwYGEgoHBw0LCAwLCQgLCgcHCAcLCAkJBwcICQoHCAoICAgHCAkLCQYICQgKCQgKCAgKCQkICAgQCwoIBgcJCQwJCAoICgoJCAsMCgcJDQwGCQgGCQgKCAkNCQcLBwkKCwgJCQoLCAkJBwkJBwoICQkICwkMCQwJCQoIBgUHCwcIDgkLCgsICAcGCQcIBwkGCgYLBwwIBwoKCQ8LCwsJCA4KCg0LCAsKCAcKCwYGCgkPCggMCwkHCAoICQkIBwoLDQoHDgsJCQsJCAcICAkGBwcJBgoIBgoLCAgOBwgJCgcMDQgICQcFCAoHCQcHCAoHEQgJBwcKCQ0JCAkHCgcIDAkICAkGCwcICAsJCgcHDgoHCAgJCAkMBggMBggICAgKCQoICQoMCAYHCgsHCwoICQoICQgIBwkJCgwLCAoKCgcHBwYHCwgJCAkJCQkLCQYKCAcIBg4ICgcIBgcJCQoMCQkJCAkICQsICgkJCAcHCAcKBggIDAkICQgIBgwJCAkHCAgJCBELCQkGCQgKBwkJCQkICgkGBwgHCAgGBwgICwoIBwcHBwgIBwcHCwsHBwkHCAoOCAkHCAcICQYLDAcIDQcIBgoKCgoHCAUGCQgICAoICQ0IBwkJCAsJBgkGCAcGBwkIBwgMCAkKCAoICggKCQgICQsHEAkGBwYKDAcKCAsJBwgJCAsHCgcICAkNCAgHCAsGCQgOCgkKDQkHCAYHBwkJCQgKCgcMCAgGCQkKDgcJCAwJCwkIEggKCAcJCQgIBwsHBwwMBgoJCgsHCgoJCAsMCQoGCAgIBwkHCAYLCgcHCAcKCQkHBwgICAgKBgkHBgsGBggKBwcHCwwJCAkLCgkHCAwICwkICA0ICQkICAcKCAgICggJCgkLCQcKCgYKCggMCAcKCgkICQgJCQoHCAsICgoIBwkHBwcGCgkHBwoIBggICQsHBwgICQkMBwgJCAgPEAoGBwgGBgoHBggKCAgLCQgJCAcHCQkJDgcIBwYNCQkKBw8QCAsICwkHDQgLCQoJCgoKDQkGBwgNBwkJCAkHCQcGBwgHCQoLCQcICwkHBw4IBwoKDAcJCAcICAoJCAcIBwgMCQoLDAoGCgcLCgkICgcHCAoKCwgICQoHCwwJCggHCQgJDQsKEAcJCQgHDAYOCAcJDggJCAcHCQsKCQgLCggLDgoKBwgIBwsHCAgIBggICAcIDQgMCAgKCggHCQgIBgsJBwgMCAgGCQsIDAwJCAoJCAkHDQkKCQYKBgoGCQgICgkIBgUICQkICggLBwkJCgcHCQgJCAoJCAgKCQoIBwcHCQgICAcMBwkJCgcLBwwKDAcNCAgJCwoICQcHCwkHCQoKBwgICggHCAcIFgkICwcLBwoJBwkICAgKCQcMBwgHCggHCQoMBwcICQgJCAgGDAcICAgJCAsJCwcKCAgHBwsICwgICAsHCAkJCAkJCAgJDwcKCg8IDQYKDwgHBwkKDAkKCAUICAoMCQcKBgYIBggICwoJBwsJCggHCAYHCAsHCQgIBwgICwcJCAgJDwYHCQcJBggJCggJCAgHCAcJCAoHBwoKCAkLDAYJCQgGDQcICQgKCQgKCgYJCgcHCQoIBwgHCAgKCQoJCAkJCQ4JCwoKCAkHBgoHCREJCgoIBwwJCAkJCQoJCAsHBgkHCgcHCAcPCAcJCAcICAoJCAsHCwgHBwoKCAgJCAgHBwgIBwgJBw0JCAkHCwkKCwUJCQgHCAgGDAgODgkJCQoLCgoKCQ0JCQcLCAgJCAcMCAcHCAkICAkKBwgHBwgKCAgIBgkHCAcICQcHCwkGBwgMCAgLCQkJCAoGBgkMCgkHDwcQCwYICggJBgYMCAgIBwkICQgKCg0JCAgKBgkICAgKCQgJBwkGCg0NBwcJBwcHCQkHCA0KCQkJCAgJCAgHBwoJCQgICAYICQcJCwcICwwICQcGCwgICAoGDAYIBwgIBwgMBgsHCAkJCgYICgoJCgkJBwoHCAYIBggKCAgHCQwJCg0JCAgKBwsJCgoHBgoIDAcKCgUIBwcMCggNCAoJBQsIBwcICAoJCggICQgOCgkICggJCgYJCAcJCQcJCAgNCggICg0JCggKBwsGCAcHCAwMCQsNCggICAgJBwsICAcRCQcJDwkHCwcMDAgICQcLDAkGCAcJBwcJCAoGBwsKCAoJCAYJBggIBwcKBwgJCA0LCAgJBwYKCAkJCAoGBwkLCgwICgkHCAgICQYJCQYLBwkJCgcKBgcKCAkICQoLBQwLBwsIBgkNBgYICAsJCAkICA0JCQsJCwoICQcHCAYKCQcHBgcKBwkHCwwHCgcJDwgJBggKBwcHCAkHCQgHCAcKCggGCAgJCgcHDAcHBwcPBwUMCwcICQkICgkGCAgICAYIDAkLCAcKBwoJCAcHCgkIBgcICQkLCAgKCwgHBwkJCAkGCQkICAkMCgoHBwkIBwgJCgcHCwgIBwcJBwwJBgwICAgKCgkMDAkMCAcICQkIDAcKCQkIBgwHCAcLDgs=' );

SELECT hllSketchEstimate(test_col2) FROM test.test;

SELECT hllSketchEstimate(sketch_union) from (select hllSketchUnion(test_col2) FROM test.test);

SELECT doubleHllSketchEstimate(test_col2) FROM test.test order by test_col;

DROP TABLE IF EXISTS test.test;

CREATE TABLE test.test
(
    `test_col` Int8,
    `test_col2` SketchBinary
) ENGINE = MergeTree() ORDER BY test_col;

INSERT INTO test.test values (1,'BQEPAsgACAADAAAAAAAAAMgAAQDFAAAAAACAPwAAQEAAAIA/AAAAQAAAQEA=');
INSERT INTO test.test values (1,'BQEPAsgACAADAAAAAAAAAMgAAQDFAAAAAACAPwAAQEAAAIA/AAAAQAAAQEA=');
INSERT INTO test.test values (1,'BQEPAsgACAADAAAAAAAAAMgAAQDFAAAAAACAPwAAQEAAAIA/AAAAQAAAQEA=');

SELECT kllSketchEstimate(0.5, 'Float32')(test_col2) FROM test.test;

DROP TABLE IF EXISTS test.test;

CREATE TABLE test.test_quantiles
(
    `test_col` Int8,
    `test_col2` SketchBinary
) ENGINE = MergeTree() ORDER BY test_col;

INSERT INTO test.test_quantiles values (1,'AgMIGgABAAACAAAAAAAAAAAAAAAAjJlAAAAAAAD0m0AAAAAAAIyZQAAAAAAA9JtA');

SELECT quantilesSketchEstimate(0.5, 'Float64')(test_col2) FROM test.test_quantiles;

INSERT INTO test.test_quantiles values (1,'AgMIGgABAAACAAAAAAAAAAAAAAAAjJlAAAAAAAD0m0AAAAAAAIyZQAAAAAAA9JtA');

SELECT doubleQuantilesSketchEstimate([0.5],test_col2_union) FROM (select quantilesSketchUnion('Float64')(test_col2) as test_col2_union from test.test_quantiles);

DROP TABLE IF EXISTS test.test_quantiles;

